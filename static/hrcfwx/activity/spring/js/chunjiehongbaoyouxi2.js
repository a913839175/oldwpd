function myhandler(i){i.preventDefault()}function game_begin(){is_can_click=0;var i='<div class="screenc-overlay" id="screenc-overlay"></div>',e='<div id="content" class="content">';e=e+'<img class="down-img img3" src="'+images_path+down_pic_base+'3.png" >',e=e+'<img class="down-img img2" src="'+images_path+down_pic_base+'2.png" >',e=e+'<img class="down-img img1" src="'+images_path+down_pic_base+'1.png" >',e+="</div>";var n='<div id="game_stage" class="game_stage"></div>';$("body").prepend(i),$("body").append(e),$("body").append(n),$("body").css("overflow","hidden"),document.body.addEventListener("touchmove",myhandler,!1);var a=$(".content").eq(0).width(),o=$(".content").eq(0).height(),s=$(".content img").eq(0).width(),t=$(".content img").eq(0).height();content_img_left=(a-s)/2,content_img_top=1*(o-t)/5,$(".content .img3").css("left",content_img_left),$(".content .img3").css("top",content_img_top),$(".content .img3").css("opacity",1)}function do_count_down(){if(countdown>1){$(".content .img"+countdown).remove(),countdown--;$(".content .img"+countdown).css("left",content_img_left),$(".content .img"+countdown).css("top",content_img_top),$(".content .img"+countdown).css("opacity",1)}else $("body").stopTime("DOWN"),countdown=3,$("#content").remove(),game_init(),setTimeout(function(){show_something(),$("body").everyTime(every_something,"GAME",show_something),$("body").everyTime(every_time,"TIME",show_time)},800)}function click_is_win(i,e){var n=is_win();if(1==n)$("body").stopTime("GAME"),$("body").stopTime("TIME"),$(".money").attr("onclick","javascript:;"),$(".no_something").remove(),time=time_sum,layer.load(),$.ajax({type:"post",url:"/?wxuser&q=springajax&doaction=rob_win",data:{ispost:1},dataType:"json",success:function(i){0==i.status&&i.data>0?game_win(i.data):300==i.status?(do_reset(),$.Zebra_Dialog('<span style="font-size:18px;">请先登录微拍贷</span>',{type:"question",custom_class:"question_dialog",buttons:[{caption:"登陆",callback:function(){var i=encodeURIComponent("/?wxuser&q=springrobred");window.location.href="/?wxuser&q=login&from="+i}},{caption:"取消",callback:function(){}}]})):($.Zebra_Dialog('<span style="font-size:18px;">'+i.info+"</span> ",{type:"information",custom_class:"info_dialog",buttons:["确定"]}),do_reset()),layer.closeAll("loading")},error:function(i){alert("传输异常，请检查网络是否正常"),layer.closeAll("loading")}});else{remainders=1;var a=Math.random()*fail_speak_sum,o=Math.floor(a);o>=fail_speak_sum&&(o=fail_speak_sum-1);var s=fail_speak_arr[o],t='<div class="game_monkey'+remainders+'3 no_something"><p>'+s+"</p></div>";$(".position").eq(e).find(".money").attr("onclick","javascript:;"),$(".position").eq(e).find(".no_something").remove(),$(".position").eq(e).find(".money_before").after(t)}}function click_wei(i,e){remainders=1;var n='<div class="game_monkey'+remainders+'3 no_something"><img src="/static/hrcfwx/activity/spring/images/newyear1.png"/></div>';$(".position").eq(e).find(".money").attr("onclick","javascript:;"),$(".position").eq(e).find(".no_something").remove(),$(".position").eq(e).find(".money_before").after(n)}function is_win(){if(max_click_num>now_click_num){now_click_num++;var i=100*Math.random();return i>win_per?!1:(now_click_num=1,!0)}return now_click_num=1,!0}function show_something(){var i=Math.random()*one_time_most,e=Math.ceil(i);0==e&&e++,$(".money").attr("onclick","javascript:;"),$(".no_something").remove();for(var n=[],a=0;a<all_postion.length;a++)n[a]=all_postion[a];for(var o=0;e>o;o++){var s=Math.random()*position_sum,t=Math.floor(s);if(t>=position_sum&&(t=position_sum-1),n[t]<position_sum){var m=n[t];n[t]=position_sum;var c=100*Math.random();if(c>red_per){var r=Math.random()*monkey_red_pic_sum,_=Math.ceil(r);0==_&&(_=1);var g=Math.random()*monkey_speak_sum,p=Math.floor(g);p>=monkey_speak_sum&&(p=monkey_speak_sum-1);var d=monkey_speak_arr[p];remainders=1;var l='<div onclick="click_is_win(this,'+m+')" class="game_monkey'+remainders+'3 no_something no_display"><img src="/static/hrcfwx/activity/spring/images/houzi_hongbao'+_+'.png"/></div>',v='<div class="game_monkey'+remainders+'4 no_something no_display">'+d+"</div>";$(".position").eq(m).find(".money").attr("onclick","click_is_win(this,"+m+")")}else{var r=Math.random()*monkey_wei_pic_sum,_=Math.ceil(r);0==_&&(_=1);var g=Math.random()*monkey_speak_sum,p=Math.ceil(g);p>=monkey_speak_sum&&(p=monkey_speak_sum-1);var d=monkey_speak_arr[p];remainders=1;var l='<div onclick="click_wei(this,'+m+')" class="game_monkey'+remainders+'3 no_something no_display"><img src="/static/hrcfwx/activity/spring/images/houzi_wei'+_+'.png"/></div>',v='<div class="game_monkey'+remainders+'4 no_something no_display">'+d+"</div>";$(".position").eq(m).find(".money").attr("onclick","click_wei(this,"+m+")")}$(".position").eq(m).find(".money_before").after(l),$(".position").eq(m).find(".money").after(v)}}setTimeout(function(){$(".no_display").css("display","block")},600)}function monkey_move_down0(i,e,n){0>i?(i+=speed_px,$(".monkey_pic").css("margin-top",i),setTimeout(function(){monkey_move_down(i,e,n)},speed)):($(".monkey_pic").css("margin-top",0),$(".speak").css("opacity",1))}function monkey_move_up0(i,e){i>e?(i-=speed_px,$(".monkey_pic").css("margin-top",i),setTimeout(function(){monkey_move_up(i,e)},speed)):($(".monkey_pic").css("margin-top",e),$(".money").attr("onclick","javascript:;"),$(".no_something").remove())}function monkey_move_up(i,e,n){i>0?(i-=speed_px,$(".monkey_pic").css("margin-top",i),setTimeout(function(){monkey_move_up(i,e,n)},speed)):($(".monkey_pic").css("margin-top",0),$(".speak").css("opacity",1))}function show_time(){time--,$("#timer_number").html(time),0>=time&&($("body").stopTime("GAME"),$("body").stopTime("TIME"),$(".position").html(""),time=time_sum,$(".money").attr("onclick","javascript:;"),layer.load(),$.ajax({type:"post",url:"/?wxuser&q=springajax&doaction=rob_time_out",data:{ispost:1},dataType:"json",success:function(i){0==i.status?game_over():300==i.status?(do_reset(),$.Zebra_Dialog('<span style="font-size:18px;">请先登录微拍贷</span>',{type:"question",custom_class:"question_dialog",buttons:[{caption:"登陆",callback:function(){var i=encodeURIComponent("/?wxuser&q=springrobred");window.location.href="/?wxuser&q=login&from="+i}},{caption:"取消",callback:function(){}}]})):($.Zebra_Dialog('<span style="font-size:18px;">'+i.info+"</span> ",{type:"information",custom_class:"info_dialog",buttons:["确定"]}),do_reset()),layer.closeAll("loading")},error:function(i){alert("传输异常，请检查网络是否正常"),console.log(i),layer.closeAll("loading")}}))}function game_init(){var i="";i+='<div class="game_in">',i+='<div class="game_clock">',i+='<img src="/static/hrcfwx/activity/spring/images/shizhong.png" />',i+="</div>",i+='<span class="timer_number" id="timer_number"></span>',i+='<div class="game_monkey1 position">',i+='<div class="game_monkey11 money_before">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai_qian.png"/>',i+="</div>",i+='<div class="game_monkey12 money">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai.png"/>',i+="</div>",i+="</div>",i+='<div class="game_monkey2 position">',i+='<div class="game_monkey11 money_before">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai_qian.png"/>',i+="</div>",i+='<div class="game_monkey12 money">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai.png"/>',i+="</div>",i+="</div>",i+='<div class="game_monkey3 position">',i+='<div class="game_monkey11 money_before">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai_qian.png"/>',i+="</div>",i+='<div class="game_monkey12 money">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai.png"/>',i+="</div>",i+="</div>",i+='<div class="game_monkey4 position">',i+='<div class="game_monkey11 money_before">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai_qian.png"/>',i+="</div>",i+='<div class="game_monkey12 money">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai.png"/>',i+="</div>",i+="</div>",i+='<div class="game_monkey5 position">',i+='<div class="game_monkey11 money_before">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai_qian.png"/>',i+="</div>",i+='<div class="game_monkey12 money">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai.png"/>',i+="</div>",i+="</div>",i+='<div class="game_monkey6 position">',i+='<div class="game_monkey11 money_before">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai_qian.png"/>',i+="</div>",i+='<div class="game_monkey12 money">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai.png"/>',i+="</div>",i+="</div>",i+='<div class="game_monkey7 position">',i+='<div class="game_monkey11 money_before">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai_qian.png"/>',i+="</div>",i+='<div class="game_monkey12 money">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai.png"/>',i+="</div>",i+="</div>",i+='<div class="game_monkey8 position">',i+='<div class="game_monkey11 money_before">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai_qian.png"/>',i+="</div>",i+='<div class="game_monkey12 money">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai.png"/>',i+="</div>",i+="</div>",i+='<div class="game_monkey9 position">',i+='<div class="game_monkey11 money_before">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai_qian.png"/>',i+="</div>",i+='<div class="game_monkey12 money">',i+='<img src="/static/hrcfwx/activity/spring/images/qiandai.png"/>',i+="</div>",i+="</div>",i+="</div>",$("#game_stage").html(i)}function game_over(){var i="";i+='<div class="game_noprize">',i+='<div class="game_lost">',i+="<p>红包只差一点点...</p>",i+="<p>很遗憾</p>",i+="<p>很遗憾，您没有抢到红包...</p>",i+="</div>",i+='<div class="game_but">',i+='<a href="javascript:;"  onclick="do_again()">',i+="<div>再抢一次</div>",i+="</a>",i+='<a href="/?wxuser&q=springrobprize">',i+="<div>我的红包</div>",i+="</a>",i+="</div>",i+="</div>",$("#game_stage").html(i)}function game_win(i){var e="";e+='<div class="game_getprize">',e+='<div class="game_get">',e+="<p>"+i+"</p>",e+="<p>理财红包</p>",e+="<p>恭喜您获得了"+i+"元理财红包 <span>1</span> 个！ </p>",e+="</div>",e+='<div class="game_but">',e+='<a href="javascript:;" onclick="do_again()"><div>再抢一次</div></a>',e+='<a href="/?wxuser&q=hongbao"><div>立即使用</div></a>',e+="</div>",e+="</div>",$("#game_stage").html(e)}function do_again(){var i=$("#mychance").html();i>0&&i--,$("#mychance").html(i),$("body").css("overflow","visible"),document.body.removeEventListener("touchmove",myhandler,!1),$("#game_stage").remove(),$("#content").remove(),$("#screenc-overlay").remove(),is_can_click=1}function do_reset(){$("body").css("overflow","visible"),document.body.removeEventListener("touchmove",myhandler,!1),$("#game_stage").remove(),$("#content").remove(),$("#screenc-overlay").remove(),is_can_click=1}var countdown_sum=3,countdown=countdown_sum,speed=10,speed_px=2,images_path="/static/hrcfwx/activity/spring/images/",down_pic_base="chunjie_hongbao_daojishi",max_click_num=6,now_click_num=1,time_sum=60,time=time_sum,content_img_left=0,content_img_top=0;every_time="1s",every_down="1s",every_something="3s";var position_sum=9,all_postion=[0,1,2,3,4,5,6,7,8],one_time_most=3,monkey_speak_sum=2,monkey_speak_arr=["<br/>&nbsp;快来戳我呀!","<br/>&nbsp;快来戳我呀!"],fail_speak_sum=2,fail_speak_arr=["哎呀，今天出门忘记带钱了...","T.T 把压岁钱还给我"],monkey_red_pic_sum=4,monkey_wei_pic_sum=4,red_per=30,win_per=20,is_can_click=1;window.onload=function(){$.preloadImages(images_path+"houzi_hongbao1.png",images_path+"houzi_hongbao2.png",images_path+"houzi_hongbao3.png",images_path+"houzi_hongbao4.png",images_path+"houzi_wei1.png",images_path+"houzi_wei2.png",images_path+"houzi_wei3.png",images_path+"houzi_wei4.png",images_path+"qiandai.png",images_path+"qiandai_qian.png",images_path+"getprize.png",images_path+"prizebut.png",images_path+"noprize.png",images_path+"newyear1.png",images_path+"chunjie_hongbao_daojishi1.png",images_path+"chunjie_hongbao_daojishi2.png",images_path+"chunjie_hongbao_daojishi3.png")},$.preloadImages=function(){for(var i=0;i<arguments.length;i++)$("<img />").attr("src",arguments[i])},$(function(){$("#begin_game").click(function(){if(1==is_can_click){var i=$("#mychance").html();mychance_int=parseInt(i),mychance_int>0?(layer.load(),$.ajax({type:"post",url:"/?wxuser&q=springajax&doaction=get_rob_game_times",dataType:"json",success:function(i){0==i.status&&i.data>0?(game_begin(),$("body").everyTime(every_down,"DOWN",do_count_down)):300==i.status?$.Zebra_Dialog('<span style="font-size:18px;">请先登录微拍贷</span>',{type:"question",custom_class:"question_dialog",buttons:[{caption:"登陆",callback:function(){var i=encodeURIComponent("/?wxuser&q=springrobred");window.location.href="/?wxuser&q=login&from="+i}},{caption:"取消",callback:function(){}}]}):$.Zebra_Dialog('<span style="font-size:18px;">'+i.info+"</span> ",{type:"information",custom_class:"info_dialog",buttons:["确定"]}),layer.closeAll("loading")},error:function(i){alert("传输异常，请检查网络是否正常"),console.log(i),layer.closeAll("loading")}})):$.Zebra_Dialog('<span style="font-size:18px;">您的机会已用完，请明天再来</span> ',{type:"information",custom_class:"info_dialog",buttons:["确定"]})}})});